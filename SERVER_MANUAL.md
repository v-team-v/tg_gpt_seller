# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–µ—Ä–≤–µ—Ä–æ–º

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
ssh root@217.198.9.71
cd /app/tg_gpt_seller
```

## 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (Docker)

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (—Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π)
–ï—Å–ª–∏ –≤—ã –≤–Ω–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥ –∏ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
docker compose up --build -d
```
–§–ª–∞–≥ `-d` –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

### –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (–±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏)
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≤–∏—Å–ª–æ):
```bash
docker compose restart
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
docker compose down
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ—à–∏–±–∫–∏, —Å–æ–æ–±—â–µ–Ω–∏—è):
```bash
# –õ–æ–≥–∏ –≤–µ–±-—Å–∞–π—Ç–∞ (–∞–¥–º–∏–Ω–∫–∏)
docker compose logs -f web

# –õ–æ–≥–∏ —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞
docker compose logs -f bot
```
–ù–∞–∂–º–∏—Ç–µ `Ctrl+C`, —á—Ç–æ–±—ã –≤—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤.

## 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (Git)

**–í–∞–∂–Ω–æ:** –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤–∞—à —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ **Push** —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (—á–µ—Ä–µ–∑ `rsync`), –∞ –Ω–µ —á–µ—Ä–µ–∑ `git pull` –Ω–∞ —Å–∞–º–æ–º —Å–µ—Ä–≤–µ—Ä–µ. –ü–∞–ø–∫–∞ `/app/tg_gpt_seller` –ø–æ–∫–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º.

### –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–µ–π—á–∞—Å (—Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞):
–ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∞–≥–µ–Ω—Ç–æ–º –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ —Å –≤–∞—à–µ–≥–æ Mac.

### –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `git pull` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
1. –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```bash
   cd /app
   rm -rf tg_gpt_seller_backup
   mv tg_gpt_seller tg_gpt_seller_backup # –°–æ—Ö—Ä–∞–Ω–∏–º —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
   git clone https://github.com/v-team-v/tg_gpt_seller.git
   cd tg_gpt_seller
   ```
   *(–°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–µ—Å—Ç–∏ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –æ—Ç GitHub –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSH-–∫–ª—é—á–∏, —Ç–∞–∫ –∫–∞–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π).*

2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `.env` —Ñ–∞–π–ª –∏–∑ –±—ç–∫–∞–ø–∞:
   ```bash
   cp ../tg_gpt_seller_backup/.env .
   ```

3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ–π:
   ```bash
   git pull
   docker compose up --build -d
   ```
## 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–ö–∞–∫ –Ω–µ —Å–ª–æ–º–∞—Ç—å –±–∞–∑—É)

### –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏?
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `nextjs` (–Ω–µ `root`). –ï—Å–ª–∏ –≤—ã —Å–∫–æ–ø–∏—Ä—É–µ—Ç–µ —Ñ–∞–π–ª—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`dev.db`) –∏–ª–∏ –ø–∞–ø–∫—É `data` –æ—Ç –∏–º–µ–Ω–∏ `root` (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `rsync` –∏–ª–∏ `cp`), –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Ç–µ—Ä—è–µ—Ç –∫ –Ω–∏–º –¥–æ—Å—Ç—É–ø, –∏ –±–æ—Ç —É–ø–∞–¥–µ—Ç —Å –æ—à–∏–±–∫–æ–π `readonly database`.

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Git (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–≠—Ç–æ —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–¥, –Ω–µ —Ç—Ä–æ–≥–∞—è –¥–∞–Ω–Ω—ã–µ.
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ª–∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git (`git push`).
2. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   git pull
   docker compose up --build -d
   ```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Rsync (–° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)
–ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Git –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –º–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞–ø—Ä—è–º—É—é. –ù–æ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –∏—Å–∫–ª—é—á–∞–π—Ç–µ –ø–∞–ø–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏!

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:
```bash
rsync -avz --exclude 'node_modules' --exclude '.next' --exclude '.git' --exclude 'data' --exclude '.env' ./ root@217.198.9.71:/app/tg_gpt_seller/
```
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
docker compose up --build -d
```

### üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ "readonly database" —É–∂–µ —Å–ª—É—á–∏–ª–∞—Å—å?
–ï—Å–ª–∏ –≤—ã —Å–ª—É—á–∞–π–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–∞–≤–∞ root, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```bash
chmod -R 777 /app/tg_gpt_seller/data
docker compose restart
```
