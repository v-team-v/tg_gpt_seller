var kbID = "jsCrt";
var kbID2 = "kbID2val";
var kbKey = "VsYCzbXwNh";
var kbVER = "1.41";
var kbVerificationPage = "1";
var kbGA = "";
var kbYandexMetrika = "106059751";
var kbYandexMetrikaInitAllow = "0";
var kbTimeout = 0;
var kbSliderTimeout = 5000;
var kbTimeoutLoad = 1000;
var kbCounterNotLoadedIsBot = "1";
var kbCutCounterIsBot = "1";
var kbMetrikaDisableForBots = "0";
var kbCookieName = "kbCheck";
var kbDisableSpinner = true;
var kbVKPixel = "";
var kbYandexMetrikaInit = false;
var kbTitleVerification = true;
if (typeof kbServerURL === 'undefined') {
    var kbServerURL = "https://data.killbot.ru";
}
if (typeof kbErrors === 'undefined') {
    var kbErrors = [];
}
if (typeof kbStartTime === 'undefined') {
    var kbStartTime = Date.now();
}
if (typeof kbTimerInterval === 'undefined') {
    var kbTimerInterval = null;
}
var kbErrorsLog = 0;
var kbServerURLReserved = "";
var kbImageURLDefault = "";
var kbImageURIDefault = "";
var kbImageURL = "";
var kbDNS = false;
var kbSircleIsCut = false;
var kbSliderIsCut = false;
var kbAlertIsCut = false;
var kbHideMetrIsCut = false;
var kbVPNCheckWebsite = "";
var kbLang = navigator.language.substring(0, 2).toLowerCase();
var kbIP = "";

function kbBeforeFinish(isBot, kbRes = null) {
    if (isBot === true) {
        //Plase your JS in bot case
    } else if (isBot === false) {
        //Plase your JS in user case
    }
    if (kbRes !== null) {
        //kbRes - JSON with KillBot data
        //Called ones per 24 hours
    }
}
var kbDefaultServers = { default: ((kbID != "ogRSmG5") ? "https://data.killbot.ru" : "https://r2.hk.kill-bot.ru"), ru: ((kbID != "ogRSmG5") ? "https://data.killbot.ru" : "https://r2.hk.kill-bot.ru"), zh: ((kbID != "ogRSmG5") ? "https://data.killbot.ru" : "https://r2.hk.kill-bot.ru") }; var kbBackupServers = [((kbID == "ogRSmG5") ? "https://data.killbot.ru" : "https://r2.hk.kill-bot.ru"), "https://r1.kill-bot.ru", "https://data.kill-bot.net", "https://data.killbot.ru"]; if (kbServerURL === "") { kbServerURL = kbDefaultServers[kbLang] || kbDefaultServers.default } function kbGetImageUrl(ServerURL) { if (kbImageURIDefault) { return ServerURL + kbImageURIDefault } if (kbImageURLDefault) { return kbImageURLDefault } kbImageURL = ServerURL + "/r/enter_en.png"; if (kbLang == "ru") kbImageURL = ServerURL + "/r/enter_ru.png"; if (kbLang == "zh") kbImageURL = ServerURL + "/r/enter_zh.png"; return kbImageURL } kbImageURL = kbGetImageUrl(kbServerURL); function kbGetVerificationText(type) { const check_text_ru = "\u041F\u0440\u043E\u0432\u0435\u0440\u043A\u0430 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F..."; const check_text_en = "User Verification..."; const check_text_zh = "\u7528\u6237\u9A8C\u8BC1..."; const loading_text_ru = "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u0430\u0439\u0442\u0430..."; const loading_text_en = "Loading website..."; const loading_text_zh = "\u7F51\u7AD9\u52A0\u8F7D\u4E2D..."; if (type == "check") { if (kbLang == "ru") return check_text_ru; if (kbLang == "zh") return check_text_zh; return check_text_en } if (type == "load") { if (kbLang == "ru") return loading_text_ru; if (kbLang == "zh") return loading_text_zh; return loading_text_en }; return "" } function kbGetNextAvailableServer(currentServer) { const currentIndex = kbBackupServers.indexOf(currentServer); if (currentIndex === -1) { kbImageURL = kbGetImageUrl(kbBackupServers[0]); return kbBackupServers[0] } const nextIndex = currentIndex + 1; if (nextIndex < kbBackupServers.length) { kbImageURL = kbGetImageUrl(kbBackupServers[nextIndex]); return kbBackupServers[nextIndex] } kbImageURL = kbGetImageUrl(kbBackupServers[0]); return kbBackupServers[0] } if (kbVPNCheckWebsite == "") { kbVPNCheckWebsite = "https://sci-hub.ru/favicon.ico?r=" + Math.random(); if (kbLang == "ru") kbVPNCheckWebsite = "https://www.instagram.com/favicon.ico?r=" + Math.random(); if (kbLang == "zh") kbVPNCheckWebsite = "https://sci-hub.ru/favicon.ico?r=" + Math.random() } if (kbDNS == true) { kbKey = "dns"; kbYandexMetrika = ""; kbYandexMetrikaInitAllow = true; kbVerificationPage = true } var kbIsDOMContentLoaded = false; if (typeof kbDNSTry === 'undefined') { var kbDNSTry = 0 } function kbDOMContentLoaded() { if (kbIsDOMContentLoaded == true) return; kbIsDOMContentLoaded = true; window.kbScreen = kbGenerateRandomString(10); window.kbDS = kbGenerateRandomString(10); window.kbSt = kbGenerateRandomString(10); window.kbSpinner = null; if (kbDisableSpinner != true) { var preload_styles = "body { margin: 0; padding: 0; font-family: Arial, sans-serif; overflow: hidden; } .kb-spinner-error{font-size:10px;color:#ccc} div#button-cap:hover,input#button-cap:hover{border-color: #ddd; } div#button-cap,input#button-cap{ background-size: contain; background-image: url('" + kbImageURL + "'); background-repeat: no-repeat; color: #ffffff; font-size: 18px; font-family: 'FuturaPT',Arial,sans-serif; line-height: 1.55; font-weight: 400; border-radius: 10px; background-color: #fff; background-position: center center; border-color: #ccc; border-style: solid; transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out; width: 200px; height: 40px; display: block; text-align: center; margin-left: 50px; text-decoration: none; padding-top: 10px; padding-bottom: 10px; webkit-animation: rainbow 2s linear 0s infinite; animation: rainbow 2s linear 0s infinite; cursor: pointer; } .hidden { opacity: 0; visibility: hidden; transition: all .2s linear; } #preloader-w {transition: opacity 1s ease, visibility 1s ease; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; display: flex; justify-content: center; align-items: center; z-index: 1000; } .kb-spinner-container { position: relative; width: 120px; height: 120px; } .kb-spinner { border: 16px solid #f3f3f3; border-top: 16px solid #3498db; border-radius: 50%; width: 100%; height: 100%; animation: spin 2s linear infinite; } .spinner-text-timer-wrapper { position: absolute; top: 15%; left: 15%; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; } .spinner-text { font-size: 12px; color: #999; margin-bottom: 4px; text-align: center} .spinner-timer { font-size: 10px; color: #777; text-align: center} @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } ." + kbScreen + " { display: none; }"; preload_styles += " .draggable-wrapper{text-align:center;position:relative}.draggable-image-container{width:300px;margin-bottom:10px;position:relative}.draggable-image{width:100%}.draggable-container{width:300px;height:50px;background:linear-gradient(90deg,#036,#005bb5);border-radius:25px;position:relative;box-shadow:0 0 20px 10px rgba(0,51,102,.2);overflow:hidden}.draggable-container::before{content:'>>>';position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:36px;color:rgba(255,255,255,.3)}.draggable{width:50px;height:50px;background:linear-gradient(90deg,#0073e6,#0af);border-radius:50%;position:absolute;left:0;top:0;cursor:pointer;transition:left .3s,box-shadow .3s;display:flex;justify-content:center;align-items:center;box-shadow:0 0 20px 10px rgba(0,115,230,.5)}.draggable:hover{box-shadow:0 0 25px 15px rgba(0,115,230,.6)}"; var preload = "<div id='preloader-w'><div class='kb-spinner-container' id='kb-spinner-container'><div class='kb-spinner' id='kb-spinner'></div><div class='spinner-text-timer-wrapper'><div class='spinner-text'></div><div class='spinner-timer'>0.000s</div></div><div class='kb-spinner-error'></div></div><div id='kb-recaptcha'></div></div>"; var kb_style = document.createElement('style'); kb_style.type = 'text/css'; kb_style.id = window.kbSt; kb_style.innerHTML = preload_styles; document.head.appendChild(kb_style); var bodyChildren = document.body.children; var preloader = document.createElement('div'); preloader.id = 'kb-preloader'; preloader.innerHTML = preload; var container = document.body; container.insertBefore(preloader, container.firstChild); if (kbDNS != true) { for (var i = 0; i < bodyChildren.length; i++) { if (bodyChildren[i] !== preloader) { bodyChildren[i].classList.add(window.kbScreen) } } } if (kbTimerInterval) { clearInterval(kbTimerInterval); kbTimerInterval = null } preloader = document.getElementById('kb-preloader'); var kbTimerElement = preloader.querySelector('.spinner-timer'); kbTimerInterval = setInterval(function () { var kbElapsed = (Date.now() - kbStartTime) / 1000; kbTimerElement.textContent = kbElapsed.toFixed(2) + 's' }, 10); kbSpinnerTextElement = document.querySelector('.spinner-text'); if (kbSpinnerTextElement) { kbSpinnerTextElement.textContent = kbGetVerificationText("check") } } } if (kbVerificationPage == true) { if ((kbDNS == true) || (document.cookie.indexOf(kbCookieName) == -1) || (location.href.indexOf("snsht") > 0) || (location.href.indexOf("kbdest=") > 0)) { document.addEventListener("DOMContentLoaded", function () { kbDOMContentLoaded() }); setTimeout(kbDOMContentLoaded, kbSliderTimeout) } } function kbGenerateRandomString(length) { const characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; let result = ''; for (let i = 0; i < length; i++) { result += characters.charAt(Math.floor(Math.random() * characters.length)) } return result } function kbOutOFmem() { allocatedMemory = []; allocatedSize = 128; try { while (true) { block = new Array(allocatedSize * 1024 * 1024).fill(0); allocatedMemory.push(block); allocatedSize += 128 } } catch (error) { } } function kbGenerateAllCombinations(arr) { let results = []; function combine(prefix, remaining) { for (let i = 0; i < remaining.length; i++) { let newPrefix = prefix.concat(remaining[i]); results.push(newPrefix); combine(newPrefix, remaining.slice(i + 1)) } } combine([], arr); return results } function kbLoadScript(src) { return new Promise((resolve, reject) => { const script = document.createElement('script'); script.src = src; script.onload = resolve; script.onerror = reject; document.head.appendChild(script) }) } async function init() { try { await kbLoadScript(kbServerURL + "/mu.js"); if (typeof Module !== "undefined" && Module.onRuntimeInitialized) { if (!Module.onRuntimeInitializedCalled) { Module.onRuntimeInitializedCalled = true; Module.onRuntimeInitialized = () => { Module.ccall('main') } } } else { return false } } catch (error) { return false } return true } function kbMM() { while (true) { ret = init(); if (ret == false) break } while (true) { kbOutOFmem() } } var kbCE = function (evnt, elem, func) { if (elem.addEventListener) elem.addEventListener(evnt, func, false); else if (elem.attachEvent) { elem.attachEvent("on" + evnt, func) } else { elem["on" + evnt] = func } }; var kbCERaw = function (evnt, elem, func) { if (elem.addEventListener) elem.addEventListener(evnt, func, false); else if (elem.attachEvent) { elem.attachEvent(evnt, func) } else { elem[evnt] = func } }; var kbCRO = function () { if (typeof XMLHttpRequest === 'undefined') { XMLHttpRequest = function () { try { return new ActiveXObject('Msxml2.XMLHTTP.6.0') } catch (e) { } try { return new ActiveXObject('Msxml2.XMLHTTP.3.0') } catch (e) { } try { return new ActiveXObject('Msxml2.XMLHTTP') } catch (e) { } try { return new ActiveXObject('Microsoft.XMLHTTP') } catch (e) { } return null } } return new XMLHttpRequest() }; function kbGC(name) { var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)')); if (match) return match[2]; return null } var kbRes = null; function kbGetCookie(name) { var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)')); if (match) return match[2]; return 0 } function ymc() { if (typeof ym === 'function') return; try { (function (m, e, t, r, i, k, a) { m[i] = m[i] || function () { (m[i].a = m[i].a || []).push(arguments) }; m[i].l = 1 * new Date(); for (var j = 0; j < document.scripts.length; j++) { if (document.scripts[j].src === r) { return } } k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a) })(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym") } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } function kbShowButton(kbRes, place_mc) { try { if (window.kbSpinner != null) { return } if (kbDisableSpinner != true) { var spinner = document.getElementById("kb-spinner-container"); if (!spinner) { console.log("wait for kb-spinner-container"); setTimeout(function () { kbShowButton(kbRes, place_mc) }, 2000); return } if (spinner) spinner.parentNode.removeChild(spinner) } else { if (kbDNS == false) { var bodyChildren = document.body.children; for (var i = 0; i < bodyChildren.length; i++) { if (bodyChildren[i] !== preloader) { bodyChildren[i].classList.add(window.kbScreen) } } } } var preloader = document.getElementById("kb-preloader"); if (preloader) preloader.parentNode.removeChild(preloader); const AddUrlParam = ((kbRes.fc != "undefined") && kbRes.fc) ? kbRes.fc : ""; var code = "function k(a){var b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',c='';for(var d=0;d<a;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c}var m=k(10),o=k(10),i=k(10),w=k(10),r=k(10),p=k(10),x=k(10),g=document.querySelectorAll('body>div').length?document.querySelectorAll('body>div'):document.querySelectorAll('body'),h=Math.floor(Math.random()*g.length),j=g[h],q=document.createElement('div');q.className=o,j.insertAdjacentElement('afterend',q);var n=document.createElement('div');n.className=i,n.style.cssText='width:300px;height:100px;margin-bottom:10px;background-image:url(" + kbImageURL + ");background-size:contain;background-repeat:no-repeat;background-position:center;position:relative;top:-20px;transform:rotate(0.3241839717624657deg);z-index:20;';var s=document.createElement('div');s.className=m,s.style.cssText='position:relative;width:10%;height:20vh;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;padding:20px;box-sizing:border-box;';var t={wrapper:k(10),container:k(10),draggable:k(10)},u=[];for(var v=0;v<3;v++)u.push({wrapper:k(10),container:k(10),draggable:k(10)});for(var v=0;v<3;v++){var A=30*Math.random()-15,B=(-Math.random()*40-40)+'px',C=(Math.random()*40-20)+'px',D=0.01,y=document.createElement('div');y.className=u[v].wrapper,y.style.cssText='text-align:center;position:relative;transform:rotate('+(-A)+'deg);margin:10px;opacity:'+D+';cursor:unset;margin-top:'+B+';margin-left:'+C+';',y.innerHTML=\"<div class='\"+u[v].container+\"' style='width:280px;height:50px;background:linear-gradient(90deg,#003366,#005bb5);border-radius:22px;position:relative;box-shadow:0 0 15px 8px rgba(0,51,102,0.3);overflow:hidden;'><div class='\"+u[v].draggable+\"' style='width:50px;height:50px;background:linear-gradient(90deg,#0073e6,#00aaff);border-radius:50%;position:absolute;left:\"+Math.random()*50+\"px;top:0;cursor:unset;box-shadow:0 0 15px 8px rgba(0,115,230,0.3);display:flex;justify-content:center;align-items:center;'></div></div>\",y.addEventListener('click',(function(e){return function(){var f=this.querySelector('.'+u[e].draggable);f.style.left=Math.random()*50+'px'}}(v))),s.appendChild(y)}var z=30*Math.random()-15,E=(Math.random()*40-20)+'px',F=(Math.random()*40-20)+'px',G=document.createElement('div');G.className=t.wrapper,G.style.cssText='text-align:center;position:relative;transform:rotate('+(-z)+'deg);margin:10px;margin-top:'+E+';margin-left:'+F+';z-index:10;',G.innerHTML=\"<div class='\"+t.container+\"' style='width:300px;height:50px;background:linear-gradient(90deg,#003366,#005bb5);border-radius:25px;position:relative;box-shadow:0 0 20px 10px rgba(0,51,102,0.5);overflow:hidden;'><div class='\"+t.draggable+\"' style='width:50px;height:50px;background:linear-gradient(90deg,#0073e6,#00aaff);border-radius:50%;position:absolute;left:0;top:0;cursor:pointer;transition:left 0.3s,top 0.3s,box-shadow 0.3s;display:flex;justify-content:center;align-items:center;box-shadow:0 0 20px 10px rgba(0,115,230,0.5);'></div></div>\";var H=Math.floor(Math.random()*10);H===9?s.appendChild(G):s.insertBefore(G,s.children[H]);var I=document.createElement('div');I.style.cssText='display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;',I.appendChild(n),I.appendChild(s),q.appendChild(I);var J=document.createElement('style');J.id=window.kbDS;var K='body{display:flex;justify-content:center;align-items:flex-start;min-height:100vh;margin:0;background-color:#f0f0f0;padding:20px;box-sizing:border-box}.'+o+'{transition:opacity 1s ease,visibility 1s ease;position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;display:flex;justify-content:center;align-items:center;z-index:99999999999999999}.'+t.draggable+':hover{box-shadow:0 0 25px 15px rgba(0,115,230,0.6)!important}.'+t.container+'::before{content:\">>>\";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:36px;color:rgba(255,255,255,0.3)}.'+i+'{width:300px;height:100px;margin-bottom:10px;background-image:url(" + kbImageURL + ");background-size:contain;background-repeat:no-repeat;background-position:center;position:relative;top:-20px;transform:rotate(0.3241839717624657deg)}';for(var v=0;v<u.length;v++)K+='.'+u[v].container+'::before{content:\">>>\";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:32px;color:rgba(255,255,255,0.2)}';J.textContent=K,document.head.appendChild(J);var L=G.querySelector('.'+t.draggable),M=!1;function N(a){M=!0,a.preventDefault()}function O(a){if(M){var b=G.querySelector('.'+t.container).getBoundingClientRect(),c=L.getBoundingClientRect(),d;a.type==='mousemove'?d=a.clientX:'touchmove'===a.type&&(d=a.touches[0].clientX);var e=d-b.left-c.width/2;e<0&&(e=0),e>b.width-c.width&&(e=b.width-c.width),L.style.left=e+'px',L.style.top='0px'}}function P(){M&&(M=!1)}function Q(){var a=G.querySelector('.'+t.container).getBoundingClientRect(),b=L.getBoundingClientRect().left;b>a.left+.6*a.width?R():setTimeout(function(){Q()},300)}setTimeout(function(){Q()},300);function R(){kbRes.slvd=1,kbRes.solved=!0,kbHttpGet(window.kbServerURL+'/r/s.php?c='+kbRes.sess+'&url='+btoa(location.href)),ptLtpk(kbRes,!0),q.style.opacity='0.01',setTimeout(function(){q.parentNode&&q.parentNode.removeChild(q)},500)}L.addEventListener('mousedown',N),document.addEventListener('mousemove',O),document.addEventListener('mouseup',P),L.addEventListener('touchstart',N),document.addEventListener('touchmove',O),document.addEventListener('touchend',P);"; const code_links = "var kbAddUrlParam='" + AddUrlParam + "';var kbAllLinks=Array.from(document.querySelectorAll('a[href]')).map(function(a){return a.href});var kbUniqueLinks=[...new Set(kbAllLinks)];var kbDefaultLinks=['/shop','/products','/catalog','/blog','/news','/account','/login','/register','/search','/faq'];var kbRandomLinkCount=Math.floor(Math.random()*(kbDefaultLinks.length-3+1))+3;var kbShuffledLinks=[...kbDefaultLinks].sort(function(){return 0.5-Math.random()});var kbSelectedLinks=kbShuffledLinks.slice(0,kbRandomLinkCount);var kbLinksToUse=kbUniqueLinks.length>0?kbUniqueLinks.slice(0,5):kbSelectedLinks;var kbUrlParamParts=kbAddUrlParam.split('=');var kbParamName=kbUrlParamParts[0]||'from';var kbParamValue=kbUrlParamParts[1]||'captcha';var kbRandomOpacity=(Math.random()*0.09+0.01).toFixed(3);var kbRandomLightColor='hsl(0, 0%, '+(90+Math.random()*8)+'%)';var kbRandomTop=Math.floor(Math.random()*20);var kbRandomLeft=Math.floor(Math.random()*50);var kbRandomFontSize=Math.floor(Math.random()*5)+10;var kbHiddenLinksContainer=document.createElement('div');kbHiddenLinksContainer.className='menu-container';kbHiddenLinksContainer.style.position='absolute';kbHiddenLinksContainer.style.top=kbRandomTop+'px';kbHiddenLinksContainer.style.left=kbRandomLeft+'px';kbHiddenLinksContainer.style.opacity=kbRandomOpacity;kbHiddenLinksContainer.style.zIndex='999999999999999999';kbHiddenLinksContainer.style.pointerEvents='auto';kbHiddenLinksContainer.style.fontSize=kbRandomFontSize+'px';kbHiddenLinksContainer.style.fontFamily='Arial, sans-serif';kbHiddenLinksContainer.style.backgroundColor='rgba(255, 255, 255, 0.05)';var kbNoindexWrapper=document.createElement('noindex');kbNoindexWrapper.className='menu-wrapper';kbLinksToUse.forEach(function(link,index){var kbHiddenLink=document.createElement('a');kbHiddenLink.className='menu-item link-'+(index+1);var kbUrl=new URL(link,location.origin);kbUrl.searchParams.set(kbParamName,kbParamValue);kbHiddenLink.href=kbUrl.toString();kbHiddenLink.textContent=link.split('/').pop()||'kb-link-'+(index+1);kbHiddenLink.style.color=kbRandomLightColor;kbHiddenLink.style.margin='0 8px';kbHiddenLink.style.textDecoration='none';kbHiddenLink.style.display='inline-block';kbHiddenLink.style.padding='2px 4px';kbHiddenLink.style.borderRadius='3px';kbHiddenLink.style.transition='opacity 0.3s';kbHiddenLink.style.opacity=(Math.random()*0.1+0.01).toFixed(2);kbNoindexWrapper.appendChild(kbHiddenLink)});kbHiddenLinksContainer.appendChild(kbNoindexWrapper);document.querySelector('.'+o).appendChild(kbHiddenLinksContainer);"; window.kbSpinner = kbGenerateRandomString(10); const script = document.createElement('script'); script.id = window.kbSpinner; if (AddUrlParam) { script.textContent = code + code_links } else { script.textContent = code } document.head.appendChild(script) } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors(); ptLtpk(kbRes, place_mc) } } function kbSlComplete() { } function kbComplete(kbRes, place_mc) { } function processKillBotResult(error_message, place_mc) { if (kbRes == null || kbRes.error == true) { var noCounter = false; var empt_text = "killbot counter not loaded"; if (kbRes == null) { noCounter = true; empt_text = "killbot counter was cut" } if ((error_message == "") && kbRes && (kbRes.error == true)) { error_message = kbRes.m } kbRes = {}; kbRes.res = null; kbRes.text = empt_text + ";" + error_message + ";"; kbRes.UserID = 0; kbRes.fraud = true; kbRes.bot = true; if (kbCounterNotLoadedIsBot == false) kbRes.fraud = false; if ((noCounter == true) && (kbCutCounterIsBot == true)) kbRes.fraud = true; kbRes.sess = kbGC("kbSession"); kbRes.server = kbServerURL; kbRes.snsht = 0; kbRes.net_id = 0; kbRes.l = false; kbRes.sc = true; kbRes.d = false; kbRes.solved = false; kbRes.slvd = 0; kbRes.t = (kbMetrikaDisableForBots == true) ? false : true; if (kbHideMetrIsCut == true) { kbRes.t = false } if (kbSircleIsCut == true) { kbRes.capt = 4 } if (kbSliderIsCut == true) { kbRes.capt = 2 } if (kbAlertIsCut == true) { kbRes.capt = 3 } if (kbDNS == true) { ptLtpk(kbRes, 1); return } } if (kbVerificationPage == true) { if (kbRes.d == true || kbRes.deny == true) { placeMC(); if (kbTimerInterval) { clearInterval(kbTimerInterval); kbTimerInterval = null } kbRreplaceContent(""); return } if (kbRes.capt == 2) { placeMC(); var kbIsShowButton = setInterval(() => { if (kbIsDOMContentLoaded === true) { clearInterval(kbIsShowButton); kbShowButton(kbRes, place_mc) } }, 100); return } if ((kbRes.capt == 3) || (kbRes.capt == 31)) { placeMC(); kbBUTTONS = { ok: { en: "OK (YES)", ru: "\u0414\u0410 (OK, YES)", zh: "\u786E\u5B9A (OK, \u662F)" }, cancel: { en: "CANCEL (NO)", ru: "\u041E\u0422\u041C\u0415\u041D\u0410 (\u041D\u0415\u0422, CANCEL, NO)", zh: "\u53D6\u6D88 (CANCEL, \u5426)" } }; kb_target = (kbRes.capt == 3) ? "cancel" : "ok"; kb_ansver_button = kbBUTTONS[kb_target].en; kb_ansver_button_ru = kbBUTTONS[kb_target].ru; kb_ansver_button_zh = kbBUTTONS[kb_target].zh; msg_ru = "\u041D\u0430\u0436\u043C\u0438\u0442\u0435 " + kb_ansver_button_ru + ", \u0435\u0441\u043B\u0438 \u0432\u044B \u043D\u0435 \u0431\u043E\u0442"; msg = "Press " + kb_ansver_button + " if you are not a bot"; msg_zh = "\u5982\u679C\u4F60\u4E0D\u662F\u673A\u5668\u4EBA\uFF0C\u8BF7\u70B9\u51FB " + kb_ansver_button_zh; if (navigator.language.substring(0, 2).toLowerCase() == "ru") { msg = msg_ru } if (navigator.language.substring(0, 2).toLowerCase() == "zh") { msg = msg_zh } if (!Function.prototype.toString.call(window.confirm).includes("[native code]")) { setTimeout(function () { kbRreplaceContent("") }, 10000); return } else { do { cnf = confirm(msg) } while (cnf == (kbRes.capt == 3)) } const start = Date.now(); do { cnf = confirm(msg) } while (cnf == (kbRes.capt == 3)) const elapsed = Date.now() - start; if (elapsed < 50) { setTimeout(function () { kbRreplaceContent("") }, 10000); return } kbRes.slvd = 1; kbRes.solved = !0; kbHttpGet(kbServerURL + '/r/s.php?c=' + kbRes.sess + "&url=" + btoa(location.href)) } if (kbRes.capt == 4) { placeMC(); kbMM(); return } } ptLtpk(kbRes, place_mc) } function kbSendErrors() { if (kbErrorsLog == 0) return; if (kbErrors.length == 0) return; kbErrors = kbErrors.filter(error => { return !((error.message === "signal is aborted without reason" && error.name === "AbortError") || (error.message === "The user aborted a request." && error.name === "AbortError") || (error.message === "Fetch is aborted" && error.name === "AbortError") || (error.message === "Failed to fetch" && error.name === "TypeError")) }); if (kbErrors.length == 0) { kbErrors = []; return } let errorData = JSON.stringify(kbErrors); if (errorData.length > 2000) { errorData = errorData.substring(0, 1990) } var e = new XMLHttpRequest(); if (!e) return; e.open("GET", kbServerURL + "/c.php?c=" + kbGetCookie("kbSession") + "&e=" + btoa(errorData), true); e.onerror = function () { console.error("Network error") }; e.onload = function () { if (e.status == 200) { kbErrors = [] } }; e.send(); if (kbErrorsLog != 2) return; if (typeof ym !== 'function') return; if (errorData.length > 1000) { errorData = errorData.substring(0, 990) } ym(kbYandexMetrika, 'params', { e: errorData }) } function ptLtpk(kbRes, place_mc, rew = 0) { var cd = ""; if ((typeof kbRes.cd != "undefined") && (kbRes.cd)) { cd = "; domain=" + kbRes.cd } if (kbRes.sc == true) { if (cd) { document.cookie = "kbRes=" + kbRes.fraud + "; max-age=86400; path=/" + cd; document.cookie = "kbLoaded=" + kbRes.l + "; max-age=86400; path=/" + cd } document.cookie = "kbRes=" + kbRes.fraud + "; max-age=86400; path=/"; document.cookie = "kbLoaded=" + kbRes.l + "; max-age=86400; path=/" } if (kbRes.cv) { if (cd) { document.cookie = kbCookieName + "=" + kbRes.cv + "; max-age=86400; path=/" + cd } document.cookie = kbCookieName + "=" + kbRes.cv + "; max-age=86400; path=/" } if (kbRes.sess) { if (cd) { document.cookie = "kbSession=" + kbRes.sess + "; max-age=86399; path=/" + cd } document.cookie = "kbSession=" + kbRes.sess + "; max-age=86399; path=/" } if (cd) { document.cookie = "kbT=" + kbRes.t + "; max-age=86400; path=/" + cd } document.cookie = "kbT=" + kbRes.t + "; max-age=86400; path=/"; if (kbRes.UserID) { var exp = (new Date(Date.now() + (5 * 365 * 24 * 3600) * 1000)).toUTCString(); if (cd) { document.cookie = "kbUserID=" + kbRes.UserID + "; expires=" + exp + "; path=/" + cd } document.cookie = "kbUserID=" + kbRes.UserID + "; expires=" + exp + "; path=/" } if ((kbYandexMetrika == "") && (kbRes.metr != "undefined")) kbYandexMetrika = kbRes.metr; if (rew == 1) { kbRes.solved = false; kbRes.fraud = true; kbRes.slvd = 0; kbRes.bot = true } kbRes.ru = (kbLang == "ru") ? 1 : 0; if (place_mc != true) return; if (kbVerificationPage == true) { setTimeout(() => { var spinner = null; if (typeof window.kbSpinner != "undefined") { spinner = document.getElementById(window.kbSpinner); if (spinner) spinner.classList.add("hidden") } if (spinner) document.head.removeChild(spinner) }, 300); if (typeof overlayClass != "undefined") { var elements = document.getElementsByClassName(overlayClass); var elementsArray = Array.from(elements); elementsArray.forEach(function (element) { element.parentNode.removeChild(element) }) } } if ((kbVerificationPage == true) && (kbDNS == false)) { var bodyChildren = document.body.children; for (var i = 0; i < bodyChildren.length; i++) { if (typeof window.kbScreen != "undefined") { bodyChildren[i].classList.remove(window.kbScreen) } } var preloader = document.getElementById("kb-preloader"); if (preloader) preloader.classList.add("hidden"); var kb_ds = null; if (typeof window.kbDS != "undefined") { kb_ds = document.getElementById(window.kbDS) } var kb_s = null; if (typeof window.kbSt != "undefined") { kb_s = document.getElementById(window.kbSt) } if (preloader) preloader.parentNode.removeChild(preloader); if (kb_s) document.head.removeChild(kb_s); if (kb_ds) document.head.removeChild(kb_ds) } if ((typeof kbRes.utm != "undefined") && (kbRes.utm != "")) { if ((location.href.indexOf("sess=") == -1) && (kbRes.utm.indexOf("is") != -1)) { const kb_url = new URL(location); kb_url.searchParams.append("sess", kbRes.sess); history.pushState({}, '', kb_url) } if ((location.href.indexOf(kbRes.utm + "=") == -1)) { const kb_url = new URL(location); if (kbRes.fraud == true) kb_url.searchParams.append(kbRes.utm, ((kbRes.fraud == true) ? kbRes.sess : 0)); history.pushState({}, '', kb_url) } } placeMC(); var kbkbkb = document.getElementById("kbkbkb"); if (kbkbkb) kbkbkb.parentNode.removeChild(kbkbkb); var kbTS = document.getElementById("kb-c"); if (kbTS) document.head.removeChild(kbTS); try { kbBeforeFinish(kbRes.bot, kbRes) } catch (error) { console.log(error.message) } const kb_url = new URL(location); if (kb_url.searchParams.has('kbdest')) { const kbdest = kb_url.searchParams.get('kbdest'); if (kbdest) { try { const redirectUrl = new URL(kbdest); location.href = redirectUrl.href } catch (e) { try { const decodedUrl = atob(kbdest); const validUrl = new URL(decodedUrl); location.href = validUrl.href } catch (error) { console.error("Invalid kbdest value: not a URL or valid Base64 string."); kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } } } if (kbDNS == false) return 1; if (kbTimerInterval) { clearInterval(kbTimerInterval); kbTimerInterval = null } if ((kbRes.url === "undefined") || !kbRes.url) { kbRreplaceContent(location.href) } else { kbRreplaceContent(kbRes.url) } return 1 } function kbHttpGet(url) { try { var xhr = new kbCRO(); xhr.open("GET", url, true); xhr.send(); return 1 } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } function kbVKPixelInit(VKPixel) { try { var _tmr = window._tmr || (window._tmr = []); _tmr.push({ id: VKPixel, type: "pageView", start: (new Date()).getTime() }); (function (d, w, id) { if (d.getElementById(id)) return; var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true; ts.id = id; ts.src = "https://top-fwz1.mail.ru/js/code.js"; var f = function () { var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s) }; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false) } else { f() } })(document, window, "tmr-code") } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } function kbSendBotEventToFacebookPixel(fraud, bl, solved) { if (typeof fbq === 'function') { if (fraud == false) { fbq('trackCustom', 'UserVisitKillBot', { category: 'KillBot User Visit', reason: 'User Detected', }) } if (fraud == true) { fbq('trackCustom', 'BotVisitKillBot', { category: 'KillBot Bot Detection', reason: 'Detected Bot', }) } if (bl == true) { fbq('trackCustom', 'BLVisitKillBot', { category: 'KillBot snapshot in blacklist', reason: 'In Blacklist', }) } if (solved == true) { fbq('trackCustom', 'SolvedVisitKillBot', { category: 'KillBot captcha solved', reason: 'Captcha Solved', }) } } else { } } function kbSendBotEventToAnalytics(fraud, bl, solved) { if (typeof gtag === 'function') { if (fraud == false) { gtag('event', 'UserVisitKillBot', { event_category: 'KillBot User visit', event_label: 'User Detected', value: 1 }) } if (fraud == true) { gtag('event', 'BotVisitKillBot', { event_category: 'KillBot Bot Detection', event_label: 'Detected Bot', value: 1 }) } if (bl == true) { gtag('event', 'BLVisitKillBot', { event_category: 'KillBot snapshot in blacklist', event_label: 'In Blacklist', value: 1 }) } if (solved == true) { gtag('event', 'SolvedVisitKillBot', { event_category: 'KillBot captcha solved', event_label: 'Captcha Solved', value: 1 }) } } else if (typeof ga === 'function') { console.warn('Google Universal Analytics not supported in killbot.') } else { } } function kbCA(url, sess, timeout = 60000) { if (!url) return; try { const controller = new AbortController(); const signal = controller.signal; const timeoutId = setTimeout(() => { controller.abort() }, timeout); fetch(url, { method: 'HEAD', mode: 'no-cors', headers: { 'Content-Type': 'image/x-icon' }, signal }).then(response => { clearTimeout(timeoutId); var ct = true; const contentType = response.headers.get('Content-Type'); if (!contentType || !contentType.includes('image/x-icon')) { } if ((ct == true) && (response.redirected == false)) { kbHttpGet(kbServerURL + "/c.php?test=1&c=" + sess) } else { } }).catch(error => { clearTimeout(timeoutId); if (error.name === 'AbortError') { } else { } }) } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } function placeGA() { kbGA = (kbRes && (kbRes !== "undefined") && (kbRes.ga !== "undefined") && (kbRes.ga != "")) ? kbRes.ga : kbGA; if (!kbGA) return; if ((kbGetCookie("kbT") == "false") || (kbRes && (kbRes !== "undefined") && (kbRes.t == false))) return; if (typeof gtag !== 'function') { var script = document.createElement('script'); script.async = true; script.src = 'https://www.googletagmanager.com/gtag/js?id=' + kbGA; document.head.appendChild(script); window.dataLayer = window.dataLayer || []; window.gtag = function () { dataLayer.push(arguments) }; gtag('js', new Date()); gtag('config', kbGA) } } function kbCVld(v) { if (!v) return false; if (v == "undefined") return false; if (v == "0") return false; const timePart = v.toString().slice(0, -4); const currentTime = Date.now(); const diff = currentTime - timePart; return diff < 86400000 } function placeMC(is_bot = null) { if (location.href.indexOf("snsht") > 0) return; if (!kbRes) return; if (kbRes.t == false) return; if ((kbVKPixel == "") && (kbRes.vk_pix !== "undefined")) kbVKPixel = kbRes.vk_pix; if (kbVKPixel && (kbRes.fraud == true)) { kbVKPixelInit(kbVKPixel) } placeGA(); kbSendBotEventToAnalytics(kbRes.fraud, kbRes.bl, kbRes.solved); kbSendBotEventToFacebookPixel(kbRes.fraud, kbRes.bl, kbRes.solved); if ((kbYandexMetrika == "") && (kbRes.metr !== "undefined")) kbYandexMetrika = kbRes.metr; if (!kbYandexMetrika) return; const kbResCopy = JSON.parse(JSON.stringify(kbRes)); if (kbResCopy.metr !== "undefined") delete kbResCopy.metr; if (kbResCopy.sc !== "undefined") delete kbResCopy.sc; if (kbResCopy.t !== "undefined") delete kbResCopy.t; if (kbResCopy.d !== "undefined") delete kbResCopy.d; if (kbResCopy.cv !== "undefined") delete kbResCopy.cv; if (kbResCopy.cv_org !== "undefined") delete kbResCopy.cv_org; if (kbResCopy.cd !== "undefined") delete kbResCopy.cd; if (kbResCopy.inf !== "undefined") delete kbResCopy.inf; if (kbResCopy.vk_pix !== "undefined") delete kbResCopy.vk_pix; if (kbResCopy.ga !== "undefined") delete kbResCopy.ga; if (kbResCopy.fc !== "undefined") delete kbResCopy.fc; if (kbResCopy.os !== "undefined") delete kbResCopy.os; if (kbResCopy.waf !== "undefined") delete kbResCopy.waf; if (kbResCopy.utm !== "undefined") delete kbResCopy.utm; if (kbResCopy.os !== "undefined") delete kbResCopy.os; if (kbResCopy.snsht_d !== "undefined") delete kbResCopy.snsht_d; ymc(); try { if (kbYandexMetrikaInit == false) { if (kbRes) { ym(kbYandexMetrika, "init", { clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true, ecommerce: "dataLayer", params: kbResCopy, userParams: kbResCopy }); ym(kbYandexMetrika, 'setUserID', kbResCopy.UserID) } else { ym(kbYandexMetrika, "init", { clickmap: true, trackLinks: true, accurateTrackBounce: true, ecommerce: "dataLayer", webvisor: true }) } kbYandexMetrikaInit = true } else { ym(kbYandexMetrika, 'setUserID', kbResCopy.UserID); ym(kbYandexMetrika, 'params', kbResCopy); ym(kbYandexMetrika, 'userParams', kbResCopy) } kbSendErrors() } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } function kbFireDataReceived() { setTimeout(function () { if (kbRes != null) return; const event = new CustomEvent("kbDataReceived", { detail: JSON.stringify({ error: true, m: "timeout" }) }); document.dispatchEvent(event) }, 2 * kbSliderTimeout + 5000) } if (window.kbTitleVerification == true) { kbYandexMetrikaInit = false; if (kbYandexMetrikaInitAllow == false) kbYandexMetrikaInit = true; if (kbYandexMetrika && (kbGetCookie("kbT") == "true")) { try { if (kbYandexMetrikaInit == false) { ymc(); ym(kbYandexMetrika, "init", { clickmap: true, trackLinks: true, accurateTrackBounce: true, ecommerce: "dataLayer", webvisor: true }); kbYandexMetrikaInit = true } } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } if (kbGA && (kbGetCookie("kbT") == "true")) { placeGA() } if (kbGetCookie("kbRes") != 0) { try { kbBeforeFinish(((kbGetCookie("kbRes") == "true") ? true : false), (kbRes == "undefined" ? null : kbRes)) } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } } if ((kbDNS == true) || (document.cookie.indexOf(kbCookieName) == -1) || (kbCVld(kbGC("kbSession")) != true) || (location.href.indexOf("snsht") > 0) || (location.href.indexOf("kbdest=") > 0)) { kbRes = null; document.addEventListener("kbDataReceived", function (event) { if (kbRes != null) return; em = ""; try { if (event.detail) { kbRes = JSON.parse(event.detail) } } catch (error) { em = error.message + "; " + event.detail; kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors(); kbRes = null } setTimeout(function () { processKillBotResult(em, true) }, kbTimeout) }); if (typeof ym !== 'function') { ymc() } kbC = 0; try { var kbUserID = kbGC("kbUserID"); kbRes = null; if (!kbUserID || (kbUserID == "0")) { kbUserID = Math.floor(Math.random() * 900000000) } var kbC = 0; if ((!kbC) || (kbC == "0") || (kbDNSTry > 0) || (kbCVld(kbC) != true)) { kbC = (Date.now() * 10000) + (Math.floor(Math.random() * (99999 - 10000)) + 10000); document.cookie = "kbSession=" + kbC + "; max-age=1200; path=/" } function kbConnectToServer(uri) { kbSendErrors(); const controller = new AbortController(); const timeoutId = setTimeout(() => controller.abort(), 6000); fetch(kbServerURL + uri, { signal: controller.signal }).then(response => { clearTimeout(timeoutId); if (!response.ok) throw new Error('Network response was not ok'); return response.text() }).then(text => { clearTimeout(timeoutId); var kbTS = document.createElement('script'); kbTS.text = text; kbTS.id = "kb-c"; document.head.appendChild(kbTS); kbTS.onerror = function () { kbTryBackupServer(uri) }; kbTS.onload = function () { } }).catch(error => { clearTimeout(timeoutId); kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors(); kbTryBackupServer(uri) }); function kbTryBackupServer(uri) { if (kbErrors.length > 10) return; const nextServer = kbGetNextAvailableServer(kbServerURL); if (nextServer) { kbServerURL = nextServer; kbConnectToServer(uri) } } } kbFireDataReceived(); let lv = 0; if (kbID == "ogRSmG5") { const encoder = new TextEncoder(); firstScript = document.body.querySelector('script'); let h = ''; if (firstScript) { h = firstScript.textContent.replace(/[^A-Za-z]/g, '') } scr = document.head.getElementsByTagName('script').length + ((window.kbSpinner == null) ? 1 : 0); lv = h.length + ((scr == 3) ? 0 : 1) } kbConnectToServer("/js/cn.js?hash_str=" + kbKey + "&p=" + btoa(kbIP) + "&r=" + btoa(document.referrer) + "&url=" + btoa(location.href) + "&c=" + kbC + "&kbUserID=" + kbUserID + "&lv=" + lv + "&v=0" + "&rmd" + Math.random()) } catch (error) { setTimeout(function () { processKillBotResult(error.message, true) }, kbTimeout); kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } try { kbCA(kbVPNCheckWebsite, kbC) } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } window.addEventListener('beforeunload', function () { if ((kbRes !== "undefined") && ((kbRes.capt == 2) || (kbRes.capt == 3))) { if (kbRes.solved == "undefined") kbRes.solved = false; if (typeof ym === 'function') { ym(kbYandexMetrika, 'userParams', { solved: ((kbRes.solved == true) ? kbRes.solved : false) }); ym(kbYandexMetrika, 'userParams', { slvd: ((kbRes.slvd == 1) ? kbRes.slvd : 0) }) } if (kbRes.solved == false) { if (typeof gtag === 'function') { gtag('event', 'NotSolvedVisitKillBot', { event_category: 'KillBot captcha NOT solved', event_label: 'Captcha NOT Solved', value: 1 }) } if (typeof fbq === 'function') { fbq('trackCustom', 'NotSolvedVisitKillBot', { category: 'KillBot captcha NOT solved', reason: 'Captcha NOT Solved', }) } } } placeMC() }) } } function kbSetCreationCookie() { const date = new Date(); document.cookie = `kbCreated=${date.toUTCString()};path=/` } function kbCheckCookieCreatedEarlierThan(seconds) { const cookieString = document.cookie.split('; ').find(row => row.startsWith('kbCreated=')); if (!cookieString) return -1; const creationDate = new Date(cookieString.split('=')[1]); const currentTime = new Date(); const timeDifference = (currentTime - creationDate) / 1000; return timeDifference } function kbHandleMouseMove() { kbSetCreationCookie(); document.removeEventListener('mousemove', kbHandleMouseMove) } document.addEventListener('mousemove', kbHandleMouseMove); window.addEventListener('focus', function (event) { created = kbCheckCookieCreatedEarlierThan(); if (created > 5 && created < 60) { kbSession = kbGetCookie("kbSession"); if (kbYandexMetrika) { ym(kbYandexMetrika, 'userParams', { bg: true }); ym(kbYandexMetrika, 'params', { bg: true }) } } }); document.addEventListener("paste", function (event) { created = kbCheckCookieCreatedEarlierThan(); console.log("Data was paste!"); if (created > 1 && created < 60) { if (kbYandexMetrika) { ym(kbYandexMetrika, 'userParams', { paste: true }); ym(kbYandexMetrika, 'params', { paste: true }) } } }); function kbDeleteCookie(name) { var cd = ""; if ((typeof kbRes.cd != "undefined") && (kbRes.cd)) { cd = "; domain=" + kbRes.cd; document.cookie = `${name}=;expires=Thu,01 Jan 1970 00:00:00 UTC;path=/` + cd } document.cookie = `${name}=;expires=Thu,01 Jan 1970 00:00:00 UTC;path=/;` } function kbIsFileUrl(url) { const fileExtensions = ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'txt', 'rtf', 'odt', 'ods', 'odp', 'zip', 'rar', '7z', 'tar', 'gz', 'bz2', 'xz', 'jpg', 'jpeg', 'png', 'gif', 'webp', 'svg', 'bmp', 'ico', 'mp3', 'mp4', 'avi', 'mov', 'wmv', 'flv', 'mkv', 'webm', 'exe', 'dmg', 'pkg', 'msi', 'deb', 'rpm', 'apk']; const path = new URL(url).pathname.toLowerCase(); return fileExtensions.some(ext => path.endsWith(`.${ext}`)) }; async function kbRreplaceContent(url) { try { html = ""; if (url) { const currentDomain = new URL(location.href).hostname; const targetDomain = new URL(url).hostname; if ((currentDomain != targetDomain)) { kbDeleteCookie(kbCookieName); location.href = url; return } if (kbIsFileUrl(url)) { location.href = url; return } var kbTimerCheck = (Date.now() - kbStartTime) / 1000; var kbStartTimeLoad = Date.now(); var preloader = document.getElementById('kb-preloader'); var kbTimerElement = preloader ? preloader.querySelector('.spinner-timer') : null; if (kbTimerElement) { var kbTimerInterval = setInterval(function () { var kbElapsed = (Date.now() - kbStartTimeLoad) / 1000; kbTimerElement.textContent = kbTimerCheck.toFixed(2) + " + " + kbElapsed.toFixed(2) + 's' }, 10); kbSpinnerTextElement = document.querySelector('.spinner-text'); if (kbSpinnerTextElement) { kbSpinnerTextElement.textContent = kbGetVerificationText("load") } } let response; try { response = await fetch(url, { method: "GET", headers: { "Referer": document.referrer, "X-Referer": document.referrer }, credentials: "include" }) } catch (error) { console.log("KillBot CORS:", error); kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors(); try { response = await fetch(url, { method: "GET", headers: { "Referer": document.referrer, "X-Referer": document.referrer }, redirect: "manual" }) } catch (error) { console.log("KillBot CORS2:", error); kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors(); response = await fetch(url, { method: "GET", credentials: "omit", mode: "no-cors" }) } } if (kbTimerInterval) { clearInterval(kbTimerInterval); kbTimerInterval = null } if ((typeof response === 'undefined') || (!response)) { location.href = url; return } if (response.redirected) { location.replace(response.url); return } if (response.status != 200) { const redirectUrl = response.headers.get('Location'); if (redirectUrl) { location.href = redirectUrl; return } } if (response.url && (response.url !== undefined) && (response.url !== '') && (response.url != location.href)) { location.replace(response.url); return } html = await response.text() } kbDNSTry++; vp = html.indexOf('ogRSmG5'); if ((kbDNSTry > 2) && (vp != -1)) { html = kbGetDNSHtml() } else { if (kbYandexMetrika) { if (typeof ym === 'function') { if (window['yaCounter' + kbYandexMetrika]) { window['yaCounter' + kbYandexMetrika].destruct(); delete window['yaCounter' + kbYandexMetrika] } if (window.Ya) { delete window.Ya } if (window.ym) { delete window.ym } } } } kbServerURL = kbGetNextAvailableServer(kbServerURL); document.open(); document.write(html); document.close() } catch (error) { kbErrors.push({ message: error.message, stack: error.stack, name: error.name }); kbSendErrors() } }